<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Module 1 – Entrepreneurship | N5 Travel Office Procedures</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
    }

    body {
      background: #f0f4f8;
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 100vh;
    }

    /* Updated header styling from your saved header */
    .main-header {
      background: linear-gradient(to right, #006699, #0099cc);
      color: white;
      padding: 2rem 1rem;
      text-align: center;
      border-bottom: 5px solid #004466;
    }
    .main-header img {
      display: block;
      margin: 0 auto 1rem;
      border-radius: 10px;
      width: 150px;
      height: 150px;
      object-fit: contain;
    }
    .main-header h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    .main-header p {
      margin: 0.3rem 0;
      font-weight: bold;
    }

    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 1400px;
      margin: 30px auto;
      padding: 0 40px 40px;
      gap: 40px;
      flex-grow: 1;
    }

    .content {
      flex: 3;
      background: #fff;
      padding: 25px 30px;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
      overflow-wrap: break-word;
      min-width: 300px;
    }

    h1, h2, h3 {
      color: #004080;
      margin-bottom: 10px;
    }

    h2 {
      margin-top: 40px;
      border-bottom: 2px solid #004080;
      padding-bottom: 5px;
    }

    h3 {
      color: #00a86b;
    }

    p {
      margin: 15px 0;
    }

    ul {
      margin: 10px 0 15px 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }

    th, td {
      border: 1px solid #444;
      padding: 10px;
      text-align: center;
    }

    th {
      background: #dce9f7;
    }

    b {
      font-weight: bold;
    }

    /* Calculator Styles */
    .calculator-container {
      flex: 1;
      max-width: 360px;
      position: sticky;
      top: 20px;
      align-self: flex-start;
      height: fit-content;
    }

    .calculator {
      background: #004080;
      color: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .display {
      background: #02395a;
      font-size: 2rem;
      padding: 12px 15px;
      border-radius: 8px;
      text-align: right;
      height: 60px;
      overflow-x: auto;
      word-break: break-all;
      white-space: nowrap;
    }

    .buttons {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 12px;
    }

    button {
      background: #0266d1;
      border: none;
      border-radius: 8px;
      font-size: 1.2rem;
      color: white;
      padding: 15px 0;
      cursor: pointer;
      transition: background-color 0.2s ease;
      user-select: none;
    }

    button:hover {
      background: #014f9c;
    }

    button.operator {
      background: #ff9500;
    }

    button.operator:hover {
      background: #cc7a00;
    }

    button.clear {
      background: #d11a2a;
    }

    button.clear:hover {
      background: #9c141f;
    }

    button.backspace {
      background: #a52a2a;
    }

    button.backspace:hover {
      background: #6e1c1c;
    }

    #equals {
      background: #00a86b;
    }

    /* Footer */
    footer {
      background-color: #004080;
      color: white;
      text-align: center;
      padding: 15px 20px;
      font-size: 0.9rem;
      box-shadow: 0 -3px 8px rgba(0,0,0,0.15);
      margin-top: auto;
    }

    /* Responsive */
    @media (max-width: 1000px) {
      .container {
        flex-direction: column;
        padding: 20px;
      }

      .calculator-container {
        max-width: 100%;
        position: relative;
        top: 0;
        margin-top: 30px;
      }

      .calculator {
        width: 100%;
      }
    }
  </style>
</head>
<body>

  <header class="main-header">
    <img src="images/logo.jpg" alt="Logo" />
    <h1>Module 1: Entrepreneurship & Accounting</h1>
    <p><strong>N5 Travel Office Procedures</strong></p>
    <p><strong>Developed by Karabo Bopape</strong></p>
  </header>

  <div class="container">

    <main class="content" id="content">
      <h1>Section B: FINANCIAL RECORDKEEPING</h1>
      <h2>Module 1 – Cash Receipts Journal (CRJ)</h2>

      <h3>Unit 2.1.1 – The Purpose of the Cash Receipts Journal</h3>
      <p>The Cash Receipts Journal (CRJ) is a specialized accounting journal used to record all cash and cheque receipts received by a business. Its primary purpose is to provide a detailed and organized record of all incoming cash flows, which is essential for effective cash management and financial reporting.</p>

      <h3>Commission</h3>
      <p>Another form of payment received that must be recorded in the CRJ is commission:</p>
      <ul>
        <li>Commission is paid by a principal (service provider) to the travel agency for sales made on the principal's behalf.</li>
        <li>The travel agency sells a product that belongs to a principal, such as airline tickets, not owned by the agency.</li>
        <li>When the client pays the travel agency, part of the money is kept (as commission) and the rest is passed on to the principal.</li>
        <li>This process is a reward structure where the principal "thanks" the agent for selling their product.</li>
      </ul>

      <h3>Commission Structure (as per syllabus)</h3>
      <table>
        <tr><th>Product</th><th>Commission</th></tr>
        <tr><td>Air ticket: Domestic</td><td>7%</td></tr>
        <tr><td>Air ticket: International</td><td>9%</td></tr>
        <tr><td>Accommodation, tours, coach ticket, cruises, train ticket, shuttle services</td><td>10%</td></tr>
        <tr><td>Car rental and travel insurance</td><td>15%</td></tr>
      </table>

      <h3>Activity to understand how commission is calculated</h3>
      <table>
        <tr><th></th><th>Commission %</th><th>Commission Amount</th><th>Creditor Amount</th></tr>
        <tr><td>1. R4 500.00</td><td>7%</td><td>R315.00</td><td>R4 185.00</td></tr>
        <tr><td>2. R8 770.00</td><td>9%</td><td>R789.30</td><td>R7 980.70</td></tr>
        <tr><td>3. R21 999.00</td><td>10%</td><td>R2 199.90</td><td>R19 799.10</td></tr>
        <tr><td>4. R49 880.00</td><td>15%</td><td>R7 482.00</td><td>R42 398.00</td></tr>
      </table>

      <h3>Explanation</h3>
      <p>On your calculator, enter: <b>R4 500 × 7% = R315</b>. This is the commission the agency keeps. Subtract this from the original amount: <b>R4 500 − R315 = R4 185</b>. This is the amount owed to the principal.</p>

      <h3>Unit 2.1.2 – Source Documents Used to Complete CRJ</h3>
      <ul>
        <li>Sales Invoices</li>
        <li>Cash Register Tapes</li>
        <li>Bank Deposit Slips</li>
        <li>Credit Notes</li>
      </ul>

      <h3>Unit 2.1.3 – Completing the CRJ Manually</h3>
      <p>Include the following fields for each transaction:</p>
      <ul>
        <li>Document Number</li>
        <li>Day</li>
        <li>Details (Customer and Principal)</li>
        <li>Analysis of Receipts</li>
        <li>Bank</li>
        <li>Debtors Control</li>
        <li>Creditors Control</li>
        <li>Commission</li>
        <li>Sundry Accounts: Amount, Folio, and Details</li>
      </ul>

      <h3>Example Cash Receipts Journal</h3>
      <table>
        <tr>
          <th colspan="13">Cash Receipts Journal – Travel Unlimited – March 2020</th>
        </tr>
        <tr>
          <th>Doc No</th><th>Day</th><th>Detail</th><th>Analysis</th><th>Dec.</th>
          <th>Bank</th><th>Dec.</th><th>Debtors</th><th>Creditors</th><th>Commission</th>
          <th colspan="3">Sundry Accounts</th>
        </tr>
        <tr>
          <th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th>
          <th>Account</th><th>Fol.</th><th>Details</th>
        </tr>
        <tr><td>559</td><td>16</td><td>PM Baloyi</td><td>3887</td><td>.00</td><td>3887</td><td>.00</td><td></td><td>3614</td><td>272</td><td></td><td></td><td></td></tr>
        <tr><td>560</td><td>19</td><td>Johansson D</td><td>12000</td><td>.00</td><td>12000</td><td>.00</td><td></td><td></td><td></td><td>Rent Income</td><td></td><td></td></tr>
        <tr><td>561</td><td>28</td><td>Senoge D</td><td>25000</td><td>.00</td><td>25000</td><td>.00</td><td></td><td></td><td></td><td>Capital</td><td></td><td></td></tr>
        <tr><td>SCCF</td><td>28</td><td>M Marais</td><td>2500</td><td>.00</td><td>27500</td><td>.00</td><td></td><td>2250</td><td>250</td><td></td><td></td><td></td></tr>
        <tr><td colspan="4"><b>Totals</b></td><td></td><td><b>43387</b></td><td>.00</td><td></td><td><b>5864</b></td><td><b>522</b></td><td><b>37000</b></td><td></td><td></td></tr>
      </table>

      <h3>Explanation</h3>
      <p>Document 559: Received R3 887 from PM Baloyi. R272 is commission, R3 614 goes to British Airways (principal).</p>
    </main>

    <!-- Calculator Sidebar -->
    <aside class="calculator-container" id="calculatorContainer">
      <div class="calculator">
        <div class="display" id="display">0</div>
        <div class="buttons">
          <button class="clear" id="allClear">AC</button>
          <button class="clear" id="clear">C</button>
          <button class="backspace" id="backspace">⌫</button>
          <button class="operator" data-op="(">(</button>
          <button class="operator" data-op=")">)</button>

          <button data-num="7">7</button>
          <button data-num="8">8</button>
          <button data-num="9">9</button>
          <button class="operator" data-op="÷">÷</button>
          <button class="operator" data-op="±">±</button>

          <button data-num="4">4</button>
          <button data-num="5">5</button>
          <button data-num="6">6</button>
          <button class="operator" data-op="×">×</button>
          <button class="operator" id="percent">%</button>

          <button data-num="1">1</button>
          <button data-num="2">2</button>
          <button data-num="3">3</button>
          <button class="operator" data-op="−">−</button>
          <button id="equals">=</button>

          <button data-num="0" style="grid-column: span 2;">0</button>
          <button data-num=".">.</button>
          <button class="operator" data-op="+">+</button>
        </div>
      </div>
    </aside>

  </div>

  <footer>
    &copy; 2025 N5 Travel Office Procedures. All rights reserved.
  </footer>

  <script>
    (() => {
      const display = document.getElementById('display');
      const allClearBtn = document.getElementById('allClear');
      const clearBtn = document.getElementById('clear');
      const backspaceBtn = document.getElementById('backspace');
      const equalsBtn = document.getElementById('equals');
      const percentBtn = document.getElementById('percent');
      const buttons = document.querySelectorAll('.buttons button');

      let expression = '';
      let lastEvaluated = false;

      // Map display operators to JS operators
      const operatorMap = {
        '÷': '/',
        '×': '*',
        '−': '-',
        '+': '+'
      };

      // Show expression or 0 if empty
      function updateDisplay() {
        display.textContent = expression || '0';
      }

      // Replace display operators with JS operators for evaluation
      function toJsExpression(expr) {
        return expr.replace(/[÷×−+]/g, op => operatorMap[op] || op);
      }

      // Validate expression before eval
      function isValidExpression(expr) {
        let balance = 0;
        for (let char of expr) {
          if (char === '(') balance++;
          else if (char === ')') balance--;
          if (balance < 0) return false;
        }
        return balance === 0;
      }

      // Evaluate expression safely
      function safeEvaluate(expr) {
        try {
          if (!isValidExpression(expr)) return 'Error';
          let jsExpr = toJsExpression(expr);

          // Handle ± operator toggle sign of last number
          if (jsExpr.includes('±')) {
            let parts = jsExpr.split(/([+\-*/()])/g).filter(Boolean);
            for (let i = parts.length - 1; i >= 0; i--) {
              if (!isNaN(parts[i])) {
                parts[i] = (-parseFloat(parts[i])).toString();
                break;
              }
            }
            jsExpr = parts.join('');
          }

          let result = eval(jsExpr);
          if (typeof result === 'number' && !isFinite(result)) return 'Error';
          return result;
        } catch {
          return 'Error';
        }
      }

      // Append characters to expression with validation
      function appendToExpression(char) {
        if (lastEvaluated) {
          if(/[0-9.(]/.test(char)) {
            expression = char;
          } else {
            expression += char;
          }
          lastEvaluated = false;
          return;
        }

        if (/[+\-×÷−+]/.test(char)) {
          if (expression === '') return;
          if (/[+\-×÷−+.]$/.test(expression)) {
            if (char === '-' && !expression.endsWith('-')) {
              expression += char;
              return;
            }
            expression = expression.slice(0, -1) + char;
            return;
          }
        }
        if (char === '.') {
          let lastNumber = expression.split(/[+\-×÷−+()]/).pop();
          if (lastNumber.includes('.')) return;
        }
        expression += char;
      }

      // Convert last number to percentage (divide by 100)
      function convertLastNumberToPercent() {
        // Regex to find last number (with optional decimal) possibly with a negative sign
        const regex = /(-?\d*\.?\d+)(?!.*\d)/;
        const match = expression.match(regex);
        if (match) {
          let numStr = match[1];
          let num = parseFloat(numStr);
          if (!isNaN(num)) {
            let percentValue = (num / 100).toString();
            // Replace the last number in expression with percentValue
            let startIndex = match.index;
            expression = expression.slice(0, startIndex) + percentValue + expression.slice(startIndex + numStr.length);
            updateDisplay();
          }
        }
      }

      updateDisplay();

      buttons.forEach(button => {
        button.addEventListener('click', () => {
          const num = button.getAttribute('data-num');
          const op = button.getAttribute('data-op');
          const id = button.id;

          if (id === 'allClear') {
            expression = '';
            updateDisplay();
            lastEvaluated = false;
            return;
          }

          if (id === 'clear') {
            expression = '';
            updateDisplay();
            lastEvaluated = false;
            return;
          }

          if (id === 'backspace') {
            if (lastEvaluated) {
              expression = '';
              lastEvaluated = false;
            } else {
              expression = expression.slice(0, -1);
            }
            updateDisplay();
            return;
          }

          if (id === 'equals') {
            if (expression === '') return;
            const result = safeEvaluate(expression);
            updateDisplay();
            expression = result.toString();
            lastEvaluated = true;
            return;
          }

          if (id === 'percent') {
            convertLastNumberToPercent();
            lastEvaluated = false;
            return;
          }

          if (num !== null) {
            appendToExpression(num);
            updateDisplay();
            return;
          }

          if (op !== null) {
            if (op === '±') {
              let re = /([+\-×÷−+()]|^)(-?\d*\.?\d*)$/;
              let match = expression.match(re);
              if (match) {
                let numberStr = match[2];
                if (numberStr) {
                  let toggled = (parseFloat(numberStr) * -1).toString();
                  expression = expression.slice(0, match.index + match[1].length) + toggled;
                }
              }
              updateDisplay();
              return;
            }
            appendToExpression(op);
            updateDisplay();
            return;
          }
        });
      });

      // Keyboard support
      window.addEventListener('keydown', e => {
        const key = e.key;
        const allowedKeys = '0123456789+-*/().%';

        if (allowedKeys.includes(key)) {
          e.preventDefault();
          let toAppend = key;

          if (key === '/') toAppend = '÷';
          else if (key === '*') toAppend = '×';
          else if (key === '-') toAppend = '−';
          else if (key === '+') toAppend = '+';
          else if (key === '%') {
            convertLastNumberToPercent();
            lastEvaluated = false;
            return;
          }

          appendToExpression(toAppend);
          updateDisplay();
        } else if (key === 'Enter' || key === '=') {
          e.preventDefault();
          if (expression === '') return;
          const result = safeEvaluate(expression);
          updateDisplay();
          expression = result.toString();
          lastEvaluated = true;
        } else if (key === 'Backspace') {
          e.preventDefault();
          if (lastEvaluated) {
            expression = '';
            lastEvaluated = false;
          } else {
            expression = expression.slice(0, -1);
          }
          updateDisplay();
        } else if (key === 'Escape') {
          e.preventDefault();
          expression = '';
          updateDisplay();
          lastEvaluated = false;
        }
      });
    })();
  </script>

</body>
</html>
